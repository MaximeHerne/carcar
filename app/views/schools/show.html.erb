
<div class="container">

    <div class="text-center">
    <div class="col-xs-12 col-sm-6">
      <h2><%= @school.name %></h2>
      <p><%= @school.address %></p>
      <p><%= @school.phone %></p>
    </div>
    </div>
    <div class="col-xs-12 col-sm-6">
      <div id="map" style="width: 100%; height: 300px;">
      </div>
    </div>
    <div class="col-xs-12 col-sm-6">
      <%= image_tag @school.picture.url(:medium) %>
    </div>
     <div class="col-xs-12">
      <h4 class="text-center">Disponibilit√©s professeurs</h4>
        <% @school.teachers.each do |teacher| %>
          <div class="col-xs-12">
            <div class="row">
            <ul>
              <li><%= image_tag teacher.picture.url(:thumb) %> <%=link_to teacher.name, teacher_path(teacher) %>
              <div class="calendar" >
                <%= week_calendar do |date| %>
                  <%= date.mday %>
                  <% (6..23).each do |hour| %>
                    <% lesson = Lesson.new(starts_at: date + hour.hours, ends_at: date + hour.hours + 3600) %>
                    <% availability = lesson.find_availability_for_teacher(params[:id]) %>
                    <%= form_for([@teacher, lesson]) do |f| %>
                      <%= f.hidden_field :starts_at %>
                      <%= f.hidden_field :ends_at %>
                      <%= f.hidden_field :availability_id %>
                      <%= hour %>h - <%= hour + 1 %>h
                      <% if availability.nil? %>
                        <% teacher_path(params[:id]) %>
                      <% elsif availability.lesson_booked?(lesson.starts_at, lesson.ends_at) == false %>
                                <%= f.submit %>
                      <% end %>
                    <% end %>
                  <% end %>
                <% end %>
              </div>
              </div>
              </li>
            </ul>
          </div>
        <% end %>
    </div>
  </div>
  <%= link_to 'choisissez un nouveau moniteur', school_add_contract_path(@school) %>
</div>

<div class="col-xs-12 col-sm-6">
  <div id="map" style="width: 100%; height: 300px;">
  </div>
</div>


<% content_for(:js) do %>
  <%= javascript_tag do %>
    $(document).on('ready', function() {
      handler = Gmaps.build('Google');
      handler.buildMap({ internal: { id: 'map' } }, function(){
        markers = handler.addMarkers(<%= raw @markers.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
      });
    })
  <% end %>
<% end %>
